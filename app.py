(here should be the latest corrected canvas code)