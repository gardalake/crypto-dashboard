(full corrected canvas content, omitted here for brevity)